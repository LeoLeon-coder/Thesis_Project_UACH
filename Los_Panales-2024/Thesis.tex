Ok, now I am having a problem with numpy, one that I did not have before. I am trying to run the code below, but I get an error related to the numpy library. I will show you the code and the error message I am getting.

import numpy as np
import io

phrase = io.open('text_favorite_author.txt', encoding='utf-8').read().lower()
print('Tamaño del escrito: {}'.format(len(phrase)))

chars = sorted(list(set(phrase)))
print(chars)

char_indices = dict((c,i) for i,c in enumerate(chars))
print(char_indices)

def build_data(text, phrase_length = 40, stride = 3):
    X = []
    Y = []
    for i in range(0, len(text) - phrase_length, stride):
        X.append(text[i: i + phrase_length])
        Y.append(text[i + phrase_length])
    return X, Y

def vectorization(X, Y, n_x, char_indices, phrase_length = 40):
    m = len(X)
    x = np.zeros((m, phrase_length, n_x), dtype=np.bool)
    y = np.zeros((m, n_x), dtype=np.bool)
    for i, sentence in enumerate(X):
        for t, char in enumerate(sentence):
            x[i, t, char_indices[char]] = 1
        y[i, char_indices[Y[i]]] = 1
    return x, y

X, Y = build_data(text = phrase, phrase_length = 40, stride = 3)
x, y = vectorization(X, Y, n_x = len(chars), char_indices = char_indices, phrase_length = 40)
print(x.shape, y.shape)

# Creando la red
from keras.layers import Dense, LSTM, Dropout
from keras.models import Sequential

model = Sequential()
model.add(LSTM(units=50, input_shape=(40, 49)))
model.add(Dropout(0.2))
model.add(Dense(units=49, activation="softmax"))
model.summary()

# Compilando

model.compile(optimizer="RMSProp", loss="categorical_crossentropy", metrics=["accuracy"])
model.fit(x, y, batch_size=128, epochs=120)

model.save("modelo_americansniper_preentrenado.h5")

example_phrase = "No tienes porque preocuparte, la vida sigue sin importar quien o que desaparezca de éste mundo"
print(len(example_phrase))

indices_char = dict((i,c) for i, c in enumerate(chars))

final_phrase = example_phrase
for i in range(1, 100, 1):
    X_, Y_ = build_data(text=final_phrase, phrase_length=40, stride=3)
    x_, y_ = vectorization(X_, Y_, n_x=len(chars), char_indices=char_indices, phrase_length=40)
    output = model.predict(x_, verbose=0)
    final_phrase += indices_char[np.argmax(output[len(output) - 1])]
    example_phrase = final_phrase[i:]
print(final_phrase)

